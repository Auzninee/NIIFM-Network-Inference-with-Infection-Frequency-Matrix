# NIIFM — Network Inference with Infection Frequency Matrix  
# NIIFM —— 感染频率矩阵的网络推断

## Overview / 项目简介

 This repository provides a Python implementation of **NIIFM (Network Inference with Infection Frequency Matrix)**.  
Given binary node-state time series generated by an **SIS** process on an unknown network, NIIFM constructs a **statistics matrix M**
and performs **Bayesian inference (Stan/CmdStanPy)** to estimate edge probabilities.

 本仓库提供 **NIIFM（Network Inference with Infection Frequency Matrix，感染频率矩阵的网络推断）** 的 Python 实现。  
给定在未知网络上由 **SIS** 传播过程产生的二值节点状态时间序列，NIIFM 将时间序列转化为 **统计量矩阵 M**，
并通过 **Stan/CmdStanPy 的贝叶斯推断** 得到网络边存在的后验概率。

---

## Repository Structure / 仓库结构

- `niifm/` — core modules / 核心模块  
  - `generate_networks.py` — generate synthetic networks and save adjacency / 生成网络并保存邻接矩阵  
  - `sis.py` — SIS simulation generating `state_nodes.txt` / SIS 模拟生成 `state_nodes.txt`  
  - `transform_m.py` — transform `state_nodes` to statistics matrix `M` / 将 `state_nodes` 转化为统计量矩阵 `M`  
  - `f1_score.py` — evaluation utilities (F1-score) / 评估工具（F1-score）  
  - `extract.py` — low-level extraction utilities / 提取统计量所需的底层函数
- `stan/`  
  - `model.stan` — NIIFM Bayesian model / NIIFM 的 Stan 模型文件
- `scripts/`  
  - `run_experiment.py` — one-command pipeline / 一键运行全流程脚本
- `outputs/` — generated results / 运行产生的输出结果（通常由 `.gitignore` 忽略）

---

## Requirements / 环境依赖


- Python 3.12.8 (recommended)
- `numpy`, `networkx`
- `cmdstanpy` + CmdStan installed

## Quick Start (One Command) / 一键快速开始
 Run a full experiment on a BA network:
 在 BA 网络上运行一次完整实验：
python -m scripts.run_experiment \
  --graph BA --n 100 --k 10 \
  --beta 0.1 --mu 1 --rho0 0.2 --T 10000 \
  --w 10000 \
  --thr 0.5

## Main Parameters / 主要参数说明
Network / 网络：
- graph {ER,BA,WS} — network type / 网络类型
- n — number of nodes / 节点数
- k — average degree (approx.) / 平均度（近似）
- seed — random seed / 随机种子
SIS / 传播模型：
- beta — infection probability / 感染概率
- mu — recovery probability / 恢复概率
- rho0 — initial infected density / 初始感染密度
- T — simulation steps / 模拟步数

## Citation / 引用
- If you use this code, please cite the NIIFM paper (to be updated).
- 如使用本代码，请引用 NIIFM 论文（后续补充正式引用信息）。

---






